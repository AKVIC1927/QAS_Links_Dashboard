<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>

    <!-- ✅ Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css">
    
    <style>
        .dropdown-menu {
            min-width: 200px;
        }

        .dropdown-submenu {
            position: relative;
        }

        .dropdown-submenu .dropdown-menu {
            display: none;
            position: absolute;
            left: 100%;
            top: 0;
        }

        .dropdown-submenu:hover > .dropdown-menu {
            display: block;
        }

        .navbar {
            flex-wrap: wrap;
            height: 50px;
            padding: 5px 10px;
            background: linear-gradient(87deg, #212529, #212229) !important;
        }

        .iframe-container {
            width: 100%;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
    </style>
</head>
<body>

    <div class="navbar navbar-expand-xl navbar-dark static-top">
        <div class="container-fluid d-flex justify-content-between align-items-center">
            <div class="navbar-brand">
                <h3 id="selectedText" style="color: white; font-size: 16px; margin: 0;">Viewing: In Yard</h3>
            </div>

            <nav class="navbar-collapse collapse d-flex justify-content-center">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="https://akvic1927.github.io/QAS---In-Yard/">Adesa Form</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="dashboardDropdown" role="button" data-bs-toggle="dropdown">Dashboard Links</a>
                        <ul class="dropdown-menu" aria-labelledby="dashboardDropdown">
                            <!-- ✅ ALL Dropdown -->
                            <li class="dropdown-submenu">
                                <a class="dropdown-item dropdown-toggle" href="#" id="allDropdown">ALL</a>
                                <ul class="dropdown-menu" aria-labelledby="allDropdown">
                                    <li><a class="dropdown-item" href="#" onclick="handleNavigation('https://dashboard.transcanauto.com/#/superAdmin/vehicles/export/?query=U2FsdGVkX1%2FUEjy1Ll6Vp3NT2QdHtUcD%2F6srmJyrnpc%2F74pn1sWxlSQtYsvEoS2X%2B7MXlzhoNvilWRIga86WLaUqywDWFHAPvww37A89AuK31p7o2V%2BecheKx%2FKnhruHVVyzapsO%2BzQK%2B%2FoMCfOblQ%3D%3D', 'ALL IN TRANSIT TO QAS'); return false;">ALL IN TRANSIT TO QAS</a></li>
                                    <li><a class="dropdown-item" href="#" onclick="handleNavigation('https://dashboard.transcanauto.com/#/superAdmin/vehicles/export/?query=U2FsdGVkX19URpzVgr9LRreNJOgxeOF2w9ibdsGqG4ijoLWsgbqDobHM6tyyMMoXfe1RGp2ea6p7BvJQ%2Bt4B3csD7FGf%2BP5YBnP1CwwW0DHiSLx8Z5LRCGpRwtSI5kd2', 'ALL IN YARD'); return false;">ALL IN YARD</a></li>
                                    <li><a class="dropdown-item" href="#" onclick="handleNavigation('https://dashboard.transcanauto.com/#/superAdmin/vehicles/export/?query=U2FsdGVkX18v%2F5A6a7ITwpciakW2gAsxnKGnkIiFMLRsTrgevKleXbmN0Kjfe7RzePKxOOv7zIDN0HXxMkrFMrw%2B1PqcW3qjuD36nCEfRb4RvI%2FhUNtDzOVHSCrJA1qZ%2FwnDMyfzP3kq0R7BkNvPRj78DddUr0OY23LFEeRTVc4%3D', 'ALL NO V.I.'); return false;">ALL NO V.I.</a></li>
                                </ul>
                            </li>

                            <!-- ✅ US Dropdown -->
                            <li class="dropdown-submenu">
                                <a class="dropdown-item dropdown-toggle" href="#">US</a>
                                <ul class="dropdown-menu">
                                    <li><a class="dropdown-item" href="#" onclick="handleNavigation('https://dashboard.transcanauto.com/#/superAdmin/vehicles/export/?query=U2FsdGVkX1%2BD9tQnilXvFONadbrNeR%2FWZUNtd3jnPmZ4x2BYkbgu3Wk%2FQZttUprUt4c%2Fd5KJhz8fTOuu%2Fu5YGTE6%2BExT4VEsHOxytbqEsCAHW6J9R3Mbla%2BL3EWdaKQoLw1pIbfG18fLnoDfTQ93XA%2BJZ2D1m05rLcIrOr1Ejl8QmZmalQb7zr%2FGvO7ls1D5', 'US GENERAL'); return false;">US GENERAL</a></li>
                                    <li><a class="dropdown-item" href="#" onclick="handleNavigation('https://dashboard.transcanauto.com/#/superAdmin/vehicles/export/?query=U2FsdGVkX18w%2BupFIcRg2aWqKa2qi5gb4b%2B3UZxWmVirDzHRXZJeu14OF9Fy7Gd3X%2BRhmaqgw9ePERYbmrOWgMdwALUNmZZBEQQ%2FOEknlstjlJV7SsBhEECqPVNKnXRtpTsMKfEPvLx%2B360NqrLMRxWDQJ%2F%2BmSK1WAjux0%2B6CmS5ir5uRNnoNpjsi68faHy9lw8Wo61%2Fry%2B8cMTVkY2JASdepfsqK%2FR%2FP3WghPY6cGypt%2BVDduLOTyETlX5wqFo3', 'US PAS PAYER PAR QAS'); return false;">US PAS PAYER PAR QAS</a></li>
                                    <li><a class="dropdown-item" href="#" onclick="handleNavigation('https://dashboard.transcanauto.com/#/superAdmin/vehicles/export/?query=U2FsdGVkX1844BYGNvmN%2BNwfxct0f5Ph2Ach61rZ7ZscGBGFX3iUxoK2T%2BATen1GN1vnSDDQDdjkceczdhoo923tP96ANRDxEicH9hn8HHE0YBZTtkfQn34zbWK6f134jbh5ab9fL3Hdxxuuf5gAfURStQBpMbYnddOxG2NPVWGByrjyCzsMxtwSr4bwU0wAGrhFuM6eqYHLcxIDitWmBfBruCd12L387z7otVlSaMk%3D', 'US PAYER PAR QAS'); return false;">US PAYER PAR QAS</a></li>
                                    <li><a class="dropdown-item" href="#" onclick="handleNavigation('https://dashboard.transcanauto.com/#/superAdmin/vehicles/export/?query=U2FsdGVkX1%2B7nBlJW%2BSmxm%2BLnf5mz4bnypbj23djQQHvmXgKJDtY63Ksi1HkmZ%2BuK%2B6xXrsmzEswHfOvsR2wPbAswW8eyrMB9j%2BvfrkR57my67wzARG%2FRqt5Sp%2BsSBuvblAlHE1DcHKvYEgkrfI9RU4kNL3YQDnPt4Tr3jV7xqht8BUyUBF4iSjsFGJXMsEfL%2F7Oq8B6fcgc%2F7Xajf55MWILzahkbBFH1pXiV3zRd1mP%2FGDZ%2BifJmNA5e%2FKEM6AN', 'US REG OK'); return false;">US REG OK</a></li>
                                    <li><a class="dropdown-item" href="#" onclick="handleNavigation('https://dashboard.transcanauto.com/#/superAdmin/vehicles/export/?query=U2FsdGVkX184VXAKZ0xAWtlbMRzBAh3GVPd4m1YJLAd3FelfdFgv5mZZw%2FC%2Bj2gbhDPPeYrYh6Xx8pjyorFVNsjPVQKBg5WCsTS2xThZltYZU6lwgRZZM6dF5AvHGENOXRhf6hGprng68npe2eBFsU61HPknHW2pOFoBgd2K9Jf6MA8HOt8yWtcPBKrrKbkMD%2Ba0Rs4MpSZ%2BZbbYfPOAOQfkrBEUyNeMWX8LzMmHEcV06e%2BZMevhYPy7s6%2FAks13', 'US NO REG'); return false;">US NO REG</a></li>
                                    <li><a class="dropdown-item" href="#" onclick="handleNavigation('https://dashboard.transcanauto.com/#/superAdmin/vehicles/export/?query=U2FsdGVkX1%2BZqUscMX7ehbdUWu%2Fje2Zkxi1CxL72BNC%2F2b0lkdwrNR5TajCZKRIzjTNE78ZbEednm35%2FzwUyaZtKdRFNW1ClCJdXsgdJ0VpK%2FojWkcO4Hvr8r5QQ6Xs2h501BYehcecL53zYwamsi2e09GsBdB0Gz1btRk2R3Tf0qRTtFx8Zaw%2FgzWisYlipT0Y%2FHNzrsegSDHKcAWa%2BwlNqakSItNXZX%2BPjrlFLRAE%3D', 'US CLUSTER DONE'); return false;">US CLUSTER DONE</a></li>
                                    <li><a class="dropdown-item" href="#" onclick="handleNavigation('https://dashboard.transcanauto.com/#/superAdmin/vehicles/export/?query=U2FsdGVkX1%2FbCI09MH5Ytcem1G4%2BsH2PC2eduT1Mwo%2FEeC%2F88mIPfUyA2vUE30BjOdI3JNoOTZYQk6FYSKz88XjnmzB9AkOYepHffH%2B3knO5aSiZZot5MtUYFafcWpWGlXztj1b54rfuCvDB1rtpgjRzaj2R%2BsZEPccAERCuDId0s4cNnXNFw90OsjokCLh1zf2X9UhgjdUvKcoDwpKBkbIDW1a2YCJH8YnY5A4QwUtMhQWogr0iOajcN6O8vVN%2F', 'US ACTIVE/NO CLUSTER'); return false;">US ACTIVE/NO CLUSTER</a></li>
                                    <li><a class="dropdown-item" href="#" onclick="handleNavigation('https://dashboard.transcanauto.com/#/superAdmin/vehicles/export/?query=U2FsdGVkX1%2BdZUngBx8Uyn2v9GqS5Ypg1tWQeOtbWA1pNxTzNDxyTZfeyeBdratoEYfBhEXgq3nl8m3Rf%2FUCkKA%2FxdlkNYdWaGDpYRtL9BOar4s0M26Z0y9C%2BHc7VvjYBsJmzKeYsASGRSitCWBQIPGJh7unHIr7UYAnpYj5CjaVmArusZ4%2BmSmtaIT4VrE6DnD9UPHql0I1LXrfJQ0Eb5E%2FwYoDq9WcI4sDnDKAyi21aRG87wnTjfE0Lye8VJvF', 'US W.O.'); return false;">US W.O.</a></li>
                                    <li><a class="dropdown-item" href="#" onclick="handleNavigation('https://dashboard.transcanauto.com/#/superAdmin/vehicles/export/?query=U2FsdGVkX18vFmiPG%2FWYZ1oOi5mGGHeYtqQjC31Pe17Dbxn79zPIDe4ChDeRC084wkoH7JCVWRVtaPI83bKyW4jLejvtrSQaoLoTgc8zcmYwsryq1xcHjzlGiUgoTsCfW%2FtqaoS1euMBRQxhSLaL01fpsS%2FrZ72DDA99mwQXdk8Kf3PCQRAC10nvEB7AugGHmVGKFqGPSbkjGRf5SZ1OR16CGUcm6vjkAcl94Cf10pLYdIkx8TRrPiBVYx6lZjFK', 'US NO V.I.'); return false;">US NO V.I.</a></li>
                                    <li><a class="dropdown-item" href="#" onclick="handleNavigation('https://dashboard.transcanauto.com/#/superAdmin/vehicles/export/?query=U2FsdGVkX1%2Fx7%2BUNKkNOx8B15k7t%2FilbksSjtsScSX9mjWjoULblufxdGB4DYdW3rB5vw9EBWMxO3bdxQkLgxvUjKOFjOvVLPJZx5FO0RnNthLePbnzfKaAp18HhzwWTfkiwT8v7TFCjfmI9xZBTFE6WnLViBGrlPzis1x7ebBUB%2FqmwpBAaVIzs10leSejsJNwnDpAQ6OWPQ2vzP1Fp598bxHmyjyb%2FeMT25TIvBMxZqRiDkfxI8SxzzQrC8oQ8', 'US HAS RECALL'); return false;">US HAS RECALL</a></li>
                                </ul>
                            </li>

                            <!-- ✅ Domestic Dropdown -->
                            <li class="dropdown-submenu">
                                <a class="dropdown-item dropdown-toggle" href="#">Domestic</a>
                                <ul class="dropdown-menu">
                                    <li><a class="dropdown-item" href="#" onclick="handleNavigation('https://dashboard.transcanauto.com/#/superAdmin/vehicles/export/?query=U2FsdGVkX18BL1U%2BY9Z8OnqIZzaf%2B499HTbZjJAVCzRBzgZefgHdTTtRY1SV2w8Eod4dyqW4V0SraZSBYXOo0vs61LnglnDSYU5Ia5LOHTLJZ3hYGAWa8wadKtsDzVbSRl2bVggPxoNu%2FyqlYoBip8DWgN2mt2meyCCs8l83y7wOn2X9C%2F%2F7NJzwTyBHq%2BGxFlWJbhKqnHciplXDloNRSZZ5LpwsF8tX4sZiIWHJQfI%3D', 'Domestic GENERAL'); return false;">Domestic GENERAL</a></li>
                                    <li><a class="dropdown-item" href="#" onclick="handleNavigation('https://dashboard.transcanauto.com/#/superAdmin/vehicles/export/?query=U2FsdGVkX19PzcL6qNop55YHTRD1kZYlhfZng1U0syela6F6YAiN3QjJfqmc1uBz8fCXqqnY%2BBU%2BIKfiw3bvdjp6J%2FbGQo0ckMEK5Q7swYTDBpojGktYOGQ%2BGhijRZtxN43ooAv5ka75PfhJJGOAJhtahrZ0Wlw60M84MfJpSV85kFjRlkzIUstZ%2BIgYw8%2F5HsP%2BdISPEuMsOVRiO42TOFjq%2B4DnFZp%2FYgs5qib8JDQ%3D', 'Domestic PAYER PAR QAS'); return false;">Domestic PAYER PAR QAS</a></li>
                                    <li><a class="dropdown-item" href="#" onclick="handleNavigation('https://dashboard.transcanauto.com/#/superAdmin/vehicles/export/?query=U2FsdGVkX18Lvr4Se7MNkFVVSidF3vH%2BeLh2qrPpB36cYTHu75pRrlEaC3%2BTxehdZf%2BU7FlyMH9WvqgY%2FY4Ng80jsxTS88R5%2Fhpg9xRuDtfLtZnFx5CwhfC2Ncc4vHnJVpHfypIKIOOdwjs8e75uHMIo%2BUKxbmNal1HdBV1CwXr4zgA6OLzxWQKMn5x2KQ5bo1O%2FGHwcYtDjjywaWot%2ByYHj7%2Bfxms4t0W8YJBToDK2H8kuHn%2B4%2BZld2EQl7mX%2BK', 'Domestic PAYER SOLD TO'); return false;">Domestic PAYER SOLD TO</a></li>
                                    <li><a class="dropdown-item" href="#" onclick="handleNavigation('https://dashboard.transcanauto.com/#/superAdmin/vehicles/business/?query=U2FsdGVkX19p9NCk1DHjws%2BBw%2FoKSfCuHgzjesRAVNubzwjgiB25BadI5dfq8Uk9pFoxNyhUqxCGlAHaE2X3Y33pH4O302veYgzkKLsclJePSkfAtlnbHIlNYqbrjow8', 'New Payment'); return false;">New Payment</a></li>
                                    <li><a class="dropdown-item" href="#" onclick="handleNavigation('https://dashboard.transcanauto.com/#/superAdmin/vehicles/business/?query=U2FsdGVkX1%2F403RiQR99j38YSXg9DOUTQDku7U8k9tSgpXBX2Vg%2BLF%2BsnpYwxBGDp9uXExGav3aCzC3E%2BwMjIA%3D%3D', 'Not Sold at QAS/in Transit to QAS'); return false;">Not Sold at QAS/in Transit to QAS</a></li>
                                    <li><a class="dropdown-item" href="#" onclick="handleNavigation('https://dashboard.transcanauto.com/#/superAdmin/vehicles/business/?query=U2FsdGVkX1%2Bs%2Bwgz3Afvp5qAV820wEdwozlWbDslsT06COXsdtoOD5imO6OFK7IHPKODm3xPHr7V0oDq89Om0isG8H64YMHnL6MeNrCl9ZDwmTJYoyTCXM44dy7yHFEjRggO%2FO6Pmu%2FraM%2F4JRX8Xg%3D%3D', 'Not Sold at QAS'); return false;">Not Sold at QAS</a></li>
                                    <li><a class="dropdown-item" href="#" onclick="handleNavigation('https://dashboard.transcanauto.com/#/superAdmin/vehicles/business/?query=U2FsdGVkX18GLEAC93SKI9KRbR2JPf%2BtPd8JjmZbvcNrPmdOkhYGqRMnRFQDpYfnZT2lZxToKjUuL6auycoJVTygs3%2BculQ%2BJ1Uplgz31606mo%2FS3WMuNsB0ccf1V1dvyzFeGnvc95C%2FOnh0olJ75w%3D%3D', 'At QAS - PAID'); return false;">At QAS - PAID</a></li>
                                </ul>
                            </li>
                            
                            <!-- ✅ CANAM Domopdown -->
                            <li class="dropdown-submenu">
                                <a class="dropdown-item dropdown-toggle" href="#">CANAM</a>
                                <ul class="dropdown-menu">
                                    <li><a class="dropdown-item" href="#" onclick="handleNavigation('https://dashboard.transcanauto.com/#/superAdmin/vehicles/business/?query=U2FsdGVkX19%2B2UCGnLaKHpLB7IWfg9lqLNiFJau%2FjW%2FymBli3mkBRicHp5N%2B%2BXLvz4aDKkn%2FN5%2F5%2BXFw5XgoZqgjzpStMVzmrGq1jA7%2FrM6BktO%2BYB5gsUULFPAXHRv4oxgcB0RDaxLAn%2FW30j24r%2BJPUjE%2FVILgPb%2BtRn8AB08%3D', 'At Steve Labelle'); return false;">At Steve Labelle</a></li>
                                    <li><a class="dropdown-item" href="#" onclick="handleNavigation('https://dashboard.transcanauto.com/#/superAdmin/vehicles/business/?query=U2FsdGVkX19VitDnl1M7djjCUuWEBcVDoikJVtrDteuTAOGrm2%2Bq%2B%2F9%2BU5vcasmkyGBY7SvAht1A9sDmieeLwqoBHrqxiKUy%2BZ9pi6%2Bey7pOIF28YWN4orlo9BmWYdXPGPwk7nQaLJKTiYqIfRdFuw%3D%3D', 'At Compliant'); return false;">At Compliant</a></li>
                                    <li><a class="dropdown-item" href="#" onclick="handleNavigation('https://dashboard.transcanauto.com/#/superAdmin/vehicles/business/?query=U2FsdGVkX18olsx9dKf62dI%2B9Bw13HI4T6R%2BwOYoIJaD6YUYPyywHwEgyIisXQBpPV13FNxKcr6QkhsOtWhytKTl7YvP%2BovlZS1B6qBzfFp8RMjjAhlvKsdhpnDJPqCnyCQ4VMTREjtIOxvxGEDJeU%2F6gHj%2B3YYEahCJgsV7mbg%3D', 'At Stateline'); return false;">At Stateline</a></li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>
            </nav>
            
            <div class="toggle-container">
                <label for="toggleOpenMode" style="color: white;">New Tab:</label>
                <input type="checkbox" id="toggleOpenMode" onchange="toggleOpenMode()">
            </div>
        </div>
    </div>

    <div class="container-fluid iframe-container">
        <iframe frameborder="0" id="dashboardFrame" src="https://dashboard.transcanauto.com/#/superAdmin/vehicles/export/"></iframe>
    </div>

    <!-- ✅ Bootstrap JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>

    <script>
        let openInNewTab = false;

        function toggleOpenMode() {
            openInNewTab = document.getElementById('toggleOpenMode').checked;
        }

        function handleNavigation(url, text) {
            if (openInNewTab) {
                window.open(url, '_blank');
            } else {
                reloadIframe(url, text);
            }
        }

        function reloadIframe(url, text) {
            var iframe = document.getElementById('dashboardFrame');
            var selectedText = document.getElementById('selectedText');
            iframe.src = '';
            setTimeout(() => {
                iframe.src = url;
                if (selectedText) selectedText.textContent = 'Viewing: ' + text;
            }, 100);
        }

        document.addEventListener("DOMContentLoaded", function () {
            document.querySelectorAll('.dropdown-submenu > a').forEach((element) => {
                element.addEventListener("click", function (e) {
                    e.preventDefault();
                    let submenu = this.nextElementSibling;
                    if (submenu && submenu.classList.contains("dropdown-menu")) {
                        submenu.classList.toggle("show");
                    }
                });
            });

            document.addEventListener('click', function (event) {
                let isDropdown = event.target.closest('.dropdown');
                if (!isDropdown) {
                    document.querySelectorAll('.dropdown-menu').forEach(menu => menu.classList.remove('show'));
                }
            });
        });

        (function() {
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.has("autoFilter")) {
                console.log("Auto-filter detected. Running script...");

                function applyDateFilter() {
                    console.log("Applying date filter...");

                    let filterButton = document.querySelector('th:nth-child(8) div > div > div > button');
                    if (filterButton) {
                        console.log("Filter button found, clicking...");
                        filterButton.click();
                    } else {
                        console.log("Filter button NOT found.");
                    }

                    setTimeout(() => {
                        let firstCalendar = document.querySelector('th:nth-child(8) div > div > div > ul > li:nth-child(1) form fieldset:nth-child(1) div > input');
                        if (firstCalendar) {
                            console.log("First calendar found, setting date...");
                            firstCalendar.click();
                            setTimeout(() => {
                                let date1 = new Date();
                                date1.setHours(date1.getHours() - 48);
                                firstCalendar.value = date1.toISOString().split('T')[0];
                                firstCalendar.dispatchEvent(new Event('change'));
                            }, 500);
                        } else {
                            console.log("First calendar NOT found.");
                        }
                    }, 1000);

                    setTimeout(() => {
                        let secondCalendar = document.querySelector('th:nth-child(8) div > div > div > ul > li:nth-child(1) form fieldset:nth-child(2) div > input');
                        if (secondCalendar) {
                            console.log("Second calendar found, setting date...");
                            secondCalendar.click();
                            setTimeout(() => {
                                let date2 = new Date();
                                secondCalendar.value = date2.toISOString().split('T')[0];
                                secondCalendar.dispatchEvent(new Event('change'));
                            }, 500);
                        } else {
                            console.log("Second calendar NOT found.");
                        }
                    }, 2000);

                    setTimeout(() => {
                        let applyButton = document.querySelector('th:nth-child(8) div > div > div > ul div div button:nth-child(1)');
                        if (applyButton) {
                            console.log("Apply button found, clicking...");
                            applyButton.click();
                        } else {
                            console.log("Apply button NOT found.");
                        }
                    }, 3000);
                }

                document.addEventListener("DOMContentLoaded", function() {
                    console.log("DOM fully loaded, running applyDateFilter...");
                    applyDateFilter();
                });
            } else {
                console.log("No auto-filter detected. Normal page load.");
            }
        })();
    </script>

</body>
</html>
